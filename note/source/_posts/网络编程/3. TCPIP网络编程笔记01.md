---
title: TCP/IPç½‘ç»œç¼–ç¨‹ç¬”è®°01
date: 2025-12-07 14:59:58
categories: ç½‘ç»œç¼–ç¨‹
tags: TCP/IPç½‘ç»œç¼–ç¨‹
---

# Linux å¸¸ç”¨å‘½ä»¤

##  æŸ¥çœ‹å½“å‰ç›®å½•ï¼špwd

- **å…¨ç§°ï¼šprint working directory**
- ä½œç”¨ï¼šæ˜¾ç¤ºå½“å‰æ‰€åœ¨è·¯å¾„ã€‚

**ç¤ºä¾‹ï¼š**

```bash
pwd
```

------

## åˆ‡æ¢ç›®å½•ï¼šcd

- **å…¨ç§°ï¼šchange directory**
- ä½œç”¨ï¼šè¿›å…¥æŒ‡å®šç›®å½•ã€‚

**å¸¸ç”¨ç”¨æ³•ï¼š**

```bash
cd /path/to/dir   # è¿›å…¥æŒ‡å®šè·¯å¾„
cd ..             # è¿”å›ä¸Šä¸€çº§ç›®å½•
cd ~              # è¿”å›ç”¨æˆ·ä¸»ç›®å½•
cd -              # è¿”å›ä¸Šä¸€æ¬¡æ‰€åœ¨ç›®å½•
```

------

## åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶ï¼šls

- **å…¨ç§°ï¼šlist (files)**
- ä½œç”¨ï¼šæŸ¥çœ‹ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸æ–‡ä»¶å¤¹ã€‚

**å¸¸ç”¨å‚æ•°ï¼š**

```bash
ls        # ç®€å•æŸ¥çœ‹
ls -l     # åˆ—è¡¨æ˜¾ç¤ºï¼ˆå«æƒé™ã€å¤§å°ã€æ—¶é—´ï¼‰
ls -a     # æ˜¾ç¤ºéšè—æ–‡ä»¶
ls -lah   # å¸¸ç”¨ç»„åˆï¼šè¯¦ç»† + å¯è¯»å¤§å° + éšè—æ–‡ä»¶
```

------

## åˆ›å»ºç›®å½•ï¼šmkdir

- **å…¨ç§°ï¼šmake directory**
- ä½œç”¨ï¼šåˆ›å»ºæ–‡ä»¶å¤¹ã€‚

**ç¤ºä¾‹ï¼š**

```bash
mkdir demo
mkdir -p project/src   # é€’å½’åˆ›å»ºç›®å½•
```

## ä¿®æ”¹æƒé™ï¼šchmod

- **å…¨ç§°ï¼šchange mode**
- ä½œç”¨ï¼šä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ï¼ˆè¯» rã€å†™ wã€æ‰§è¡Œ xï¼‰ã€‚

Linux æƒé™åˆ†ä¸ºä¸‰ç±»ï¼š

- **u**ï¼šuserï¼ˆæ–‡ä»¶æ‰€æœ‰è€…ï¼‰
- **g**ï¼šgroupï¼ˆç”¨æˆ·ç»„ï¼‰
- **o**ï¼šothersï¼ˆå…¶ä»–ç”¨æˆ·ï¼‰
- **a**ï¼šallï¼ˆu+g+oï¼‰

æƒé™ç¬¦å·ï¼š

- **r**ï¼šreadï¼ˆè¯»å–ï¼‰
- **w**ï¼šwriteï¼ˆå†™å…¥ï¼‰
- **x**ï¼šexecuteï¼ˆæ‰§è¡Œï¼‰

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
chmod u+r file      # ç»™æ‰€æœ‰è€…å¢åŠ è¯»æƒé™
chmod u-w file      # ç§»é™¤æ‰€æœ‰è€…çš„å†™æƒé™
chmod g+x file      # ç»™ç”¨æˆ·ç»„å¢åŠ æ‰§è¡Œæƒé™
chmod a+r file      # æ‰€æœ‰äººæ·»åŠ è¯»æƒé™
chmod o-r file      # others ç§»é™¤è¯»æƒé™
```

ä½¿ç”¨æ•°å­—è®¾ç½®æƒé™ï¼š

æ•°å­—æƒé™ç”± **r=4, w=2, x=1** ç»„åˆè€Œæˆï¼Œä¾‹å¦‚ï¼š

| æƒé™ | æ•°å­— | è¯´æ˜           |
| ---- | ---- | -------------- |
| rwx  | 7    | å¯è¯»å¯å†™å¯æ‰§è¡Œ |
| rw-  | 6    | å¯è¯»å¯å†™       |
| r-x  | 5    | å¯è¯»å¯æ‰§è¡Œ     |
| r--  | 4    | åªè¯»           |

ç¤ºä¾‹ï¼š

```bash
chmod 755 script.sh   # rwx r-x r-x
chmod 644 file.txt    # rw- r-- r--
chmod 600 private.txt # rw- --- ---
```

------

------

## æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼ˆåˆ†é¡µæµè§ˆï¼‰ï¼šless

- **å…¨ç§°ï¼šlessï¼ˆä¸æ˜¯ç¼©å†™ï¼‰**
- ä½œç”¨ï¼šåˆ†é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œå¯å‘ä¸Šå‘ä¸‹æ»šåŠ¨ï¼Œæ¯” `cat` æ›´é€‚åˆçœ‹å¤§æ–‡ä»¶ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
less file.txt       # æŸ¥çœ‹æ–‡ä»¶
less -N file.txt    # æ˜¾ç¤ºè¡Œå·
less +10 file.txt   # ä»ç¬¬ 10 è¡Œå¼€å§‹æ˜¾ç¤º
command | less      # å°†å‘½ä»¤è¾“å‡ºåˆ†é¡µæ˜¾ç¤º
```

å¸¸ç”¨å¿«æ·é”®ï¼š

| æŒ‰é”®              | åŠŸèƒ½                |
| ----------------- | ------------------- |
| **q**             | é€€å‡ºï¼ˆQuitï¼‰        |
| â†‘ / â†“             | ä¸Šä¸‹ç§»åŠ¨ä¸€è¡Œ        |
| PageUp / PageDown | ç¿»é¡µ                |
| **/å…³é”®å­—**       | æœç´¢å­—ç¬¦ä¸²          |
| **n / N**         | æŸ¥æ‰¾ä¸‹ä¸€ä¸ª / ä¸Šä¸€ä¸ª |
| **g**             | è·³åˆ°æ–‡ä»¶å¼€å¤´ï¼ˆgoï¼‰  |
| **G**             | è·³åˆ°æ–‡ä»¶æœ«å°¾        |

------

ä¸‹é¢æˆ‘ç»§ç»­æŒ‰ç…§ä½ å–œæ¬¢çš„æ ¼å¼ï¼Œæ•´ç† **touchã€catã€cpã€rmã€mvã€grepã€findã€psã€top** çš„ç¬”è®°ï¼Œå†…å®¹æ¸…æ™°ç»Ÿä¸€ï¼Œé€‚åˆæ•´ç†æˆæ–‡æ¡£ã€‚

------

## åˆ›å»ºç©ºæ–‡ä»¶ / ä¿®æ”¹æ—¶é—´æˆ³ï¼štouch

- **å…¨ç§°ï¼štouchï¼ˆä¸æ˜¯ç¼©å†™ï¼‰**
- ä½œç”¨ï¼šåˆ›å»ºç©ºæ–‡ä»¶ï¼Œæˆ–æ›´æ–°æ–‡ä»¶çš„è®¿é—®/ä¿®æ”¹æ—¶é—´ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
touch file.txt           # åˆ›å»ºç©ºæ–‡ä»¶ï¼ˆè‹¥å·²æœ‰æ–‡ä»¶åˆ™æ›´æ–°æ—¶é—´æˆ³ï¼‰
touch a b c              # åŒæ—¶åˆ›å»ºå¤šä¸ªæ–‡ä»¶
touch -t 202401011200 f  # è®¾ç½®æ–‡ä»¶æ—¶é—´ä¸º 2024-01-01 12:00
```

------

## è¾“å‡ºæ–‡ä»¶å†…å®¹ï¼šcat

- **å…¨ç§°ï¼šconcatenate**
- ä½œç”¨ï¼šæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œæˆ–å°†å¤šä¸ªæ–‡ä»¶è¿æ¥è¾“å‡ºã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
cat file.txt            # è¾“å‡ºæ•´ä¸ªæ–‡ä»¶
cat file1 file2         # è¿ç»­è¾“å‡ºå¤šä¸ªæ–‡ä»¶
cat -n file.txt         # æ˜¾ç¤ºè¡Œå·
cat > file.txt          # è¦†ç›–å†™å…¥ï¼ˆæ…ç”¨ï¼‰
cat >> file.txt         # è¿½åŠ å†™å…¥
```

------

## å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ï¼šcp

- **å…¨ç§°ï¼šcopy**
- ä½œç”¨ï¼šå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
cp a.txt b.txt          # å¤åˆ¶æ–‡ä»¶
cp -i a.txt b.txt       # è¦†ç›–å‰è¯¢é—®
cp -v a.txt b.txt       # æ˜¾ç¤ºå¤åˆ¶è¿‡ç¨‹
cp -r dir1 dir2         # å¤åˆ¶ç›®å½•ï¼ˆrecursiveï¼‰
```

------

## åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼šrm

- **å…¨ç§°ï¼šremove**
- ä½œç”¨ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚

âš  **å±é™©æ“ä½œï¼Œè¯·æ…ç”¨ï¼Œå°¤å…¶æ˜¯ `rm -rf`**

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
rm a.txt                # åˆ é™¤æ–‡ä»¶
rm -i a.txt             # åˆ é™¤å‰ç¡®è®¤
rm -r folder/           # åˆ é™¤ç›®å½•ï¼ˆé€’å½’ï¼‰
rm -rf folder/          # å¼ºåˆ¶åˆ é™¤ï¼Œä¸æç¤ºï¼ˆå±é™©ï¼‰
```

------

## ç§»åŠ¨æˆ–é‡å‘½åï¼šmv

- **å…¨ç§°ï¼šmove**
- ä½œç”¨ï¼šç§»åŠ¨æ–‡ä»¶æˆ–é‡å‘½åæ–‡ä»¶ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
mv old.txt new.txt      # é‡å‘½å
mv file.txt folder/     # ç§»åŠ¨æ–‡ä»¶åˆ°ç›®å½•
mv -i old.txt new.txt   # è¦†ç›–å‰ç¡®è®¤
```

------

## æœç´¢æ–‡æœ¬å†…å®¹ï¼šgrep

- **å…¨ç§°ï¼šglobal regular expression print**
- ä½œç”¨ï¼šåœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾åŒ¹é…å­—ç¬¦ä¸²ï¼Œå¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
grep "hello" file.txt          # æŸ¥æ‰¾åŒ…å« hello çš„è¡Œ
grep -i "hello" file.txt       # å¿½ç•¥å¤§å°å†™
grep -n "hello" file.txt       # æ˜¾ç¤ºè¡Œå·
grep -r "main" .               # é€’å½’æœç´¢ç›®å½•
grep -v "test" file.txt        # æ’é™¤åŒ¹é… test çš„è¡Œ
```

------

## æŸ¥æ‰¾æ–‡ä»¶ï¼šfind

- **å…¨ç§°ï¼šfindï¼ˆä¸æ˜¯ç¼©å†™ï¼‰**
- ä½œç”¨ï¼šæŒ‰æ¡ä»¶æœç´¢æ–‡ä»¶æˆ–ç›®å½•ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
find . -name "*.c"             # æŸ¥æ‰¾æ‰€æœ‰ .c æ–‡ä»¶
find /path -type d             # æŸ¥æ‰¾ç›®å½•
find . -size +1M               # æŸ¥æ‰¾å¤§äº 1MB çš„æ–‡ä»¶
find . -mtime -1               # æŸ¥æ‰¾ 24 å°æ—¶å†…ä¿®æ”¹çš„æ–‡ä»¶
find . -name "*.log" -delete   # åˆ é™¤åŒ¹é…æ–‡ä»¶ï¼ˆæ…ç”¨ï¼‰
```

------

## æŸ¥çœ‹è¿›ç¨‹ï¼šps

- **å…¨ç§°ï¼šprocess status**
- ä½œç”¨ï¼šæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
ps                     # æŸ¥çœ‹å½“å‰ç»ˆç«¯ä¸‹çš„è¿›ç¨‹
ps aux                 # æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
ps -ef                 # å…¨æ ¼å¼æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹
ps aux | grep gcc      # æŸ¥æ‰¾ç›¸å…³è¿›ç¨‹
```

------

## å®æ—¶ç›‘æ§ç³»ç»Ÿï¼štop

- **å…¨ç§°ï¼štopï¼ˆä¸æ˜¯ç¼©å†™ï¼‰**
- ä½œç”¨ï¼šå®æ—¶æ˜¾ç¤º CPUã€å†…å­˜ã€è¿›ç¨‹ç­‰çŠ¶æ€ï¼Œç±»ä¼¼ä»»åŠ¡ç®¡ç†å™¨ã€‚

å¸¸ç”¨ç”¨æ³•ï¼š

```bash
top                    # æ‰“å¼€å®æ—¶ç›‘æ§ç•Œé¢
```

å¸¸ç”¨æ“ä½œï¼š

| æŒ‰é”® | åŠŸèƒ½                       |
| ---- | -------------------------- |
| q    | é€€å‡º                       |
| k    | æ€æ­»è¿›ç¨‹ï¼ˆä¼šæç¤ºè¾“å…¥ PIDï¼‰ |
| P    | æŒ‰ CPU ä½¿ç”¨ç‡æ’åº          |
| M    | æŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åº           |
| 1    | æ˜¾ç¤ºæ¯ä¸ª CPU æ ¸å¿ƒè´Ÿè½½      |

# nano ç¼–è¾‘å™¨

nano æ˜¯ Linux ä¸‹éå¸¸æ˜“ç”¨çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œé€‚åˆæ–°æ‰‹ç¼–å†™ C ç¨‹åºä¸ç®€å•æ–‡æœ¬ã€‚

------

## nano å¸¸ç”¨æ“ä½œå¿«æ·é”®

| æ“ä½œ         | å¿«æ·é”®       | å«ä¹‰                    |
| ------------ | ------------ | ----------------------- |
| ä¿å­˜æ–‡ä»¶     | **Ctrl + O** | Write Outï¼ˆå†™å‡ºåˆ°æ–‡ä»¶ï¼‰ |
| é€€å‡º nano    | **Ctrl + X** | Exitï¼ˆé€€å‡ºï¼‰            |
| å‰ªåˆ‡         | **Ctrl + K** | Cutï¼ˆå‰ªåˆ‡è¡Œæˆ–é€‰ä¸­åŒºåŸŸï¼‰ |
| ç²˜è´´         | **Ctrl + U** | Pasteï¼ˆç²˜è´´ï¼‰           |
| æœç´¢         | **Ctrl + W** | Where isï¼ˆæŸ¥æ‰¾ï¼‰        |
| æ’¤é”€         | **Alt + U**  | Undoï¼ˆæ’¤é”€ï¼‰            |
| é‡åš         | **Alt + E**  | Redoï¼ˆé‡åšï¼‰            |
| æ˜¾ç¤ºå…‰æ ‡ä½ç½® | **Ctrl + C** | Locationï¼ˆè¡Œåˆ—ä½ç½®ï¼‰    |

nano åº•éƒ¨æ˜¾ç¤ºçš„ `^` è¡¨ç¤º Ctrlï¼Œ `^X` = Ctrl + Xã€‚

------

## nano æ¨èé…ç½®

åˆ›å»ºæˆ–ç¼–è¾‘ nano é…ç½®æ–‡ä»¶ï¼š

```bash
nano ~/.nanorc
```

åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š

```nanorc
## æ˜¾ç¤ºè¡Œå·
set linenumbers

## Tab ç›¸å…³è®¾ç½®
set tabsize 4
set tabstospaces

## è‡ªåŠ¨ç¼©è¿›
set autoindent

## æ˜¾ç¤ºå…‰æ ‡ä½ç½®
set constantshow

## é¼ æ ‡æ”¯æŒ
set mouse

## è¯­æ³•é«˜äº®
include "/usr/share/nano/*.nanorc"
```

------

------

# Linux ä¸‹ä½¿ç”¨ gcc ç¼–è¯‘ä¸è¿è¡Œ C ç¨‹åº

gccï¼ˆGNU Compiler Collectionï¼‰æ˜¯ Linux ä¸­æœ€å¸¸ç”¨çš„ C ç¼–è¯‘å™¨ã€‚

------

## åŸºç¡€ç¼–è¯‘å‘½ä»¤

å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼š

```
hello.c
```

ä½¿ç”¨ gcc ç¼–è¯‘ï¼š

```bash
gcc hello.c -o hello
```

è¯´æ˜ï¼š

| å‚æ•°       | å«ä¹‰                               |
| ---------- | ---------------------------------- |
| `hello.c`  | è¦ç¼–è¯‘çš„æºæ–‡ä»¶                     |
| `-o hello` | è¾“å‡ºæ–‡ä»¶åï¼ˆç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ helloï¼‰ |

å¦‚æœä¸å†™ `-o hello`ï¼Œè¾“å‡ºæ–‡ä»¶ä¼šå« `a.out`ã€‚

------

## è¿è¡Œç¨‹åº

ç¼–è¯‘æˆåŠŸåè¿è¡Œï¼š

```bash
./hello
```

æ³¨æ„ï¼šLinux ä¸­æ‰§è¡Œå½“å‰ç›®å½•ä¸‹çš„ç¨‹åºå¿…é¡»åŠ  `./`ã€‚

------

## æ¨èå¸¦è­¦å‘Šçš„ç¼–è¯‘æ–¹å¼

```bash
gcc hello.c -o hello -Wall
```

`-Wall` ä¼šå¼€å¯æ›´å¤šè­¦å‘Šï¼Œæœ‰åŠ©äºå‘ç°ä»£ç é—®é¢˜ã€‚

------

ä¸‹é¢æˆ‘ç»™ä½ ä¸€ä¸ª **å®Œæ•´ã€æ¸…æ™°ã€éå¸¸é€‚åˆåˆå­¦è€…ç†è§£çš„è§£é‡Š**ï¼Œå¸®åŠ©ä½ å½»åº•å¼„æ‡‚ï¼š

- Linux ä¸­ **æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptor, FDï¼‰** æ˜¯ä»€ä¹ˆ
- Windows ä¸­ **å¥æŸ„ï¼ˆHandleï¼‰** æ˜¯ä»€ä¹ˆ
- ä¸¤è€…çš„åŒºåˆ«
- ä¸ºä»€ä¹ˆå®ƒä»¬çœ‹ä¼¼ç›¸ä¼¼ã€ä½†æœ¬è´¨ä¸åŒ

------

# æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptorï¼‰

åœ¨ Linux ä¸­ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼ˆEverything is a fileï¼‰ã€‚

åŒ…æ‹¬ï¼š

- æ™®é€šæ–‡ä»¶
- ç›®å½•
- ç»ˆç«¯
- ç®¡é“
- å¥—æ¥å­—ï¼ˆsocketï¼‰
- è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚ç£ç›˜ã€ä¸²å£ï¼‰

å½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€è¿™äº›èµ„æºæ—¶ï¼ŒLinux ä¼šè¿”å›ä¸€ä¸ª **éè´Ÿæ•´æ•°**ã€‚
 è¿™ä¸ªæ•´æ•°å°±æ˜¯ï¼š

## æ–‡ä»¶æè¿°ç¬¦çš„ç¼–å·è§„åˆ™

Linux è§„å®šï¼š

| æ–‡ä»¶æè¿°ç¬¦ç¼–å· | å«ä¹‰                   |
| -------------- | ---------------------- |
| **0**          | æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰      |
| **1**          | æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰     |
| **2**          | æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆstderrï¼‰ |

å½“ä½ è¿è¡Œç¨‹åºæ—¶ï¼Œè¿™ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯è‡ªåŠ¨æ‰“å¼€çš„ã€‚

------

## å½“ç¨‹åºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ

ä¾‹å¦‚ï¼š

```c
int fd = open("hello.txt", O_RDONLY);
```

ç³»ç»Ÿè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä¾‹å¦‚ï¼š

```
fd = 3
```

è¯´æ˜è¯¥è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­ï¼Œ3 å·é¡¹æŒ‡å‘ `hello.txt` çš„å†…æ ¸å¯¹è±¡ã€‚

### è¿›ç¨‹å†…éƒ¨ç»“æ„ï¼ˆç®€åŒ–ç¤ºæ„ï¼‰

```
æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼ˆæ•°ç»„ï¼‰ï¼š
0 â†’ stdin
1 â†’ stdout
2 â†’ stderr
3 â†’ hello.txt
4 â†’ socket
5 â†’ pipe
```

**æ–‡ä»¶æè¿°ç¬¦æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„çš„ç´¢å¼•ï¼Œç±»å‹æ˜¯ intã€‚**

------

### æ–‡ä»¶æè¿°ç¬¦çš„æ ¸å¿ƒç‰¹æ€§

âœ” **ç®€å•ï¼šå°±æ˜¯ä¸€ä¸ª int**

ä¸åƒ Windows çš„å¥æŸ„æ˜¯ç»“æ„ä½“ï¼ŒLinux çš„æ–‡ä»¶æè¿°ç¬¦éå¸¸è½»é‡ã€‚

âœ” **è¿›ç¨‹ç§æœ‰**

ä¸åŒè¿›ç¨‹çš„ FD ç¼–å·æ— å…³ï¼Œä½†å¯ä»¥é€šè¿‡ `fork()` ç»§æ‰¿ã€‚

âœ” **ç”±å†…æ ¸ç»´æŠ¤å¼•ç”¨**

FD æŒ‡å‘ä¸€ä¸ªå†…æ ¸å¯¹è±¡ï¼ˆæ–‡ä»¶ã€socketã€ç®¡é“ç­‰ï¼‰ã€‚

------

## Windows çš„å¥æŸ„ï¼ˆHandleï¼‰

åœ¨ Windows ä¸‹ï¼Œå¥æŸ„æ˜¯ï¼š

> **ç”¨äºæ ‡è¯†å„ç§ç³»ç»Ÿå¯¹è±¡çš„æŠ½è±¡æ ‡è¯†ç¬¦**

åŒ…æ‹¬ï¼š

- æ–‡ä»¶
- çª—å£ï¼ˆWindowï¼‰
- çº¿ç¨‹ï¼ˆThreadï¼‰
- è¿›ç¨‹ï¼ˆProcessï¼‰
- GDI å›¾å½¢å¯¹è±¡ï¼ˆç”»ç¬”ã€å­—ä½“ï¼‰
- æ³¨å†Œè¡¨é”®

å¥æŸ„ä¸æ˜¯ç®€å•æ•´æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªå†…æ ¸åˆ›å»ºçš„ **æŠ½è±¡å¼•ç”¨**ï¼Œå†…éƒ¨ç»“æ„å¤æ‚ï¼Œä¸å¯¹ç”¨æˆ·å…¬å¼€ã€‚

Windows å¥æŸ„æ˜¯ï¼šğŸ‘‰ ä¸åŒç§ç±»ã€ä¸åŒç±»å‹çš„å¯¹è±¡ç»Ÿä¸€ä½¿ç”¨çš„â€œæŒ‡é’ˆâ€

------

## Linux FD vs Windows Handle

| ç‰¹æ€§                        | Linux æ–‡ä»¶æè¿°ç¬¦         | Windows å¥æŸ„                                |
| --------------------------- | ------------------------ | ------------------------------------------- |
| **ç±»å‹**                    | intï¼ˆæ•´æ•°ï¼‰              | å†…æ ¸å¯¹è±¡å¼•ç”¨ï¼ˆç»“æ„ä½“ã€æŒ‡é’ˆç­‰ï¼‰              |
| **æ˜¯å¦ç»Ÿä¸€è¡¨ç¤ºå¯¹è±¡**        | ç»Ÿä¸€è¡¨ç¤º"æ–‡ä»¶ç±»å¯¹è±¡"     | ç»Ÿä¸€è¡¨ç¤ºå„ç§ç³»ç»Ÿå¯¹è±¡                        |
| **ä½œç”¨å¯¹è±¡**                | æ–‡ä»¶ã€socketã€ç®¡é“ã€è®¾å¤‡ | æ–‡ä»¶ã€çº¿ç¨‹ã€çª—å£ã€GDIã€æ³¨å†Œè¡¨ç­‰å‡ ä¹æ‰€æœ‰èµ„æº |
| **æ˜¯å¦ç®€å•**                | éå¸¸ç®€å•ï¼ˆintï¼‰          | è¾ƒå¤æ‚                                      |
| **å¯å¦è·¨ç³»ç»Ÿå…±äº«**          | ä¸è¡Œï¼ˆè¿›ç¨‹ç§æœ‰ï¼‰         | ä¹Ÿä¸è¡Œï¼Œä½†ç±»å‹æ›´å¤š                          |
| **æ˜¯å¦è¡¨ç¤ºçª—å£ç­‰ GUI å¯¹è±¡** | ä¸ä¼š                     | ä¼šï¼ˆä¾‹å¦‚ HWNDï¼‰                             |
| **æ˜¯å¦ç”¨äºç½‘ç»œ socket**     | æ˜¯                       | æ˜¯ï¼ˆWSA ä½¿ç”¨ Handleï¼‰                       |

Linux çš„æ–‡ä»¶æè¿°ç¬¦æ›´åƒæ˜¯ï¼š

ğŸ‘‰ **å†…æ ¸ä¸ºè¿›ç¨‹å‡†å¤‡çš„ä¸€ä¸ªâ€œæ–‡ä»¶å¼•ç”¨æ•°ç»„â€çš„ä¸‹æ ‡**

è€Œ Windows çš„å¥æŸ„æ›´åƒï¼š

ğŸ‘‰ **å„ç§ç³»ç»Ÿå¯¹è±¡çš„é€šç”¨å¯¹è±¡å¼•ç”¨**

Linux çš„æ–‡ä»¶æè¿°ç¬¦å°±åƒâ€œåº§ä½å·â€ã€‚

```
0 å·åº§ä½ â†’ stdin
1 å·åº§ä½ â†’ stdout
2 å·åº§ä½ â†’ stderr
3 å·åº§ä½ â†’ æ‰“å¼€çš„æ–‡ä»¶
4 å·åº§ä½ â†’ socket
```

æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ä¸€æ’åº§ä½ã€‚

Windows çš„å¥æŸ„åƒæ˜¯â€œå„ç§ä¸åŒæˆ¿é—´çš„é’¥åŒ™â€ã€‚

ä½ å¯èƒ½æœ‰ï¼š

- æ–‡ä»¶çš„é’¥åŒ™
- çª—å£çš„é’¥åŒ™
- çº¿ç¨‹çš„é’¥åŒ™
- æ³¨å†Œè¡¨çš„é’¥åŒ™

å®ƒä»¬éƒ½å«â€œkeyâ€ï¼ˆå¥æŸ„ï¼‰ï¼Œä½†å†…éƒ¨å½¢çŠ¶ä¸åŒã€ç”¨é€”ä¸åŒã€‚

------

## ä¸ºä»€ä¹ˆ Linux ä¸ç”¨å¥æŸ„ï¼Œè€Œæ˜¯ç”¨æ–‡ä»¶æè¿°ç¬¦

å› ä¸º Linux æ ¸å¿ƒè®¾è®¡ç†å¿µï¼š

ğŸ **ä¸€åˆ‡çš†æ–‡ä»¶**

- ç½‘ç»œè¿æ¥çœ‹æˆæ–‡ä»¶
- è®¾å¤‡çœ‹æˆæ–‡ä»¶
- ç®¡é“çœ‹æˆæ–‡ä»¶

æ‰€ä»¥ï¼š

ğŸ‘‰ **åªéœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„ int ç±»å‹å°±è¶³å¤Ÿè¡¨ç¤ºæ‰€æœ‰ I/O å¯¹è±¡**

ä¸åƒ Windowsï¼Œéœ€è¦ä¸åŒç§ç±»çš„å¥æŸ„æ¥å¤„ç† GUIã€çº¿ç¨‹ã€äº‹ä»¶ç­‰å¤æ‚å¯¹è±¡ã€‚

------

## ä½¿ç”¨ç¤ºä¾‹å¯¹æ¯”

------

### **Linuxï¼šæ‰“å¼€æ–‡ä»¶**

```c
int fd = open("a.txt", O_RDONLY);
```

è¿”å›ï¼š

```
fd = 3   // æ•´æ•°
```

------

### **Windowsï¼šæ‰“å¼€æ–‡ä»¶**

```c
HANDLE h = CreateFile(...);
```

è¿”å›ï¼š

```
h = 0x000003F4   // ä¸€ä¸ªå¤æ‚ç»“æ„çš„å¼•ç”¨
```

å®Œå…¨ä¸åŒã€‚

------

## æ€»ç»“

âœ” Linux æ–‡ä»¶æè¿°ç¬¦ï¼š

- æœ¬è´¨æ˜¯ **int**
- æ˜¯â€œæ–‡ä»¶ç±»å¯¹è±¡â€çš„ç´¢å¼•ï¼ˆarray indexï¼‰
- ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œå› æ­¤ FD ç»Ÿä¸€ä¸”ç®€æ´

âœ” Windows å¥æŸ„ï¼š

- æœ¬è´¨æ˜¯ **å†…æ ¸å¯¹è±¡å¼•ç”¨**
- å¯è¡¨ç¤ºä¸åŒç§ç±»å¯¹è±¡ï¼ˆçª—å£ã€çº¿ç¨‹ã€æ–‡ä»¶ç­‰ï¼‰
- ç»“æ„å¤æ‚ï¼Œæ˜¯ä¸€ä¸ªæŠ½è±¡æŒ‡é’ˆ

âœ” ä¸¤è€…ä¹‹é—´æœ€å¤§çš„åŒºåˆ«ï¼šâ­ **Linux çš„ FD ç®€å•ç»Ÿä¸€ï¼›Windows çš„ Handle å¤šç§å¤šæ ·ä¸”å¤æ‚ã€‚**

# C/Sé€šä¿¡ä»£ç 

![image-20251207150559513](https://blog-1314964800.cos.ap-beijing.myqcloud.com/blog/image-20251207150559513.png)

hello_server.c
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <sys/socket.h>

void error_handling(char* message);

int main(int argc, char* argv[]) {
    int server_sock;
    int client_sock;

    struct sockaddr_in server_addr;
    struct sockaddr_in client_addr;
    socklen_t client_addr_size;

    char message[] = "hello world";
    if (argc != 2) {
        printf("Usage: %s <port>\n", argv[0]);
        exit(1);
    }

    server_sock = socket(PF_INET, SOCK_STREAM, 0);
    if (server_sock == -1) {
        error_handling("socker() error");
        exit(1);
    }

    memset(&server_addr, 0, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);
    server_addr.sin_port = htons(atoi(argv[1]));

    if (bind(server_sock, (struct sockaddr*)&server_addr, sizeof(server_addr)) == -1) {
        error_handling("bind() error");
    }

    if (listen(server_sock, 5) == -1) {
        error_handling("listen error");
    }

    client_addr_size = sizeof(client_addr);
    client_sock = accept(server_sock, (struct sockaddr*)&client_addr, &client_addr_size);
    if (client_sock == -1) {
        error_handling("accept() error");
    }

    write(client_sock, message, sizeof(message));
    close(client_sock);
    close(server_sock);

    return 0;

}

void error_handling(char* message) {
    fputs(message, stderr);
    fputc('\n', stderr);
    exit(1);

}

```

hello_client.c

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <sys/socket.h>

void error_handling(char* message);

int main(int argc, char* argv[]) {
    int sock;
    struct sockaddr_in server_addr;
    char message[30];
    int str_len;

    if (argc != 3) {
        printf("Usage: %s <IP> <port>\n", argv[0]);
        exit(1);
    }

    sock = socket(PF_INET, SOCK_STREAM, 0);
    if (sock == -1) {
        error_handling("socket() error");
    }

    memset(&server_addr, 0, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_addr.s_addr = inet_addr(argv[1]);
    server_addr.sin_port = htons(atoi(argv[2]));

    if (connect(sock, (struct sockaddr*)&server_addr, sizeof(server_addr)) == -1) {
        error_handling("connect() error");
    }

    str_len = read(sock, message, sizeof(message) - 1);
    if (str_len == -1) {
        error_handling("read() error");
    }

    printf("message from server: %s\n", message);
    close(sock);
    
    return 0;
}

void error_handling(char* message) {
    fputs(message, stderr);
    fputc('\n', stderr);
    exit(1);
}

```

âœ” **å¥—æ¥å­—æ˜¯ç½‘ç»œé€šä¿¡çš„â€œæ¥å£â€**
âœ” **åœ¨ Linux ä¸­ï¼Œsocket å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆæ•´æ•°ï¼‰**
âœ” **æ‰€æœ‰ç½‘ç»œé€šä¿¡æœ€ç»ˆéƒ½ç”± socket å®ç°**

# WSL2 + VS Code

åœ¨ **WSL2 ä¸‹ä½¿ç”¨ VS Code** æ˜¯æœ€æ¨èçš„ C/C++ã€Python ç­‰å¼€å‘æ–¹å¼ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒå¯ä»¥ï¼š

- åœ¨ **Linux æ–‡ä»¶ç³»ç»Ÿ** ä¸­ç¼–å†™ä»£ç 
- ä½¿ç”¨ VS Code çš„ UIã€æ‰©å±•å’Œè‡ªåŠ¨è¡¥å…¨
- ä½¿ç”¨ Linux çš„ gcc/g++ã€gdb ç­‰å·¥å…·
- Windows ä¸ Linux æ–‡ä»¶å…±äº«éå¸¸æ–¹ä¾¿

------

## å®‰è£… VS Code

ä¸‹è½½åœ°å€ï¼š https://code.visualstudio.com/

------

## å®‰è£… VS Code çš„ WSL æ‰©å±•

æ‰“å¼€ VS Code â†’ å·¦ä¾§æ‰©å±•ï¼ˆæ–¹å—å›¾æ ‡ï¼‰
 æœç´¢ï¼š

```
WSL
```

å®‰è£… **Remote - WSL** æ‰©å±•ï¼ˆå¾®è½¯å®˜æ–¹ï¼‰ã€‚

å®‰è£…å VS Code å°±èƒ½è¿æ¥ WSLã€‚

------

## åœ¨ WSL ä¸­ä½¿ç”¨ VS Code æ‰“å¼€é¡¹ç›®

åœ¨ WSL ç»ˆç«¯ä¸­ï¼ˆä¾‹å¦‚ Ubuntuï¼‰è¿›å…¥ä½ çš„é¡¹ç›®ç›®å½•ï¼Œä¾‹å¦‚ï¼š

```bash
cd ~/projects
```

ç„¶åä½¿ç”¨ï¼š

```bash
code .
```

æ³¨æ„ï¼šæœ€åçš„ **`.`** è¡¨ç¤ºâ€œæ‰“å¼€å½“å‰ç›®å½•â€ã€‚

ğŸ” ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ VS Code ä¼šæç¤ºï¼š

```
Installing VS Code Server for WSL...
```

è¿™æ˜¯æ­£å¸¸çš„ï¼Œå®ƒä¼šè‡ªåŠ¨å®‰è£…å¿…è¦ç»„ä»¶ã€‚

å®‰è£…å®Œæˆå VS Code ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ï¼š

```
WSL: Ubuntu
```

ä½ ä¼šåœ¨ VS Code å·¦ä¸‹è§’çœ‹åˆ°ç»¿è‰²å›¾æ ‡ï¼Œæ˜¾ç¤ºï¼š

```
WSL: Ubuntu
```

è¿™è¡¨ç¤ºï¼šâ­ ä½ ç°åœ¨æ­£åœ¨ç”¨ VS Code ç¼–è¾‘ Linux é‡Œçš„æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ Windows çš„æ–‡ä»¶ â­

------

## éªŒè¯ VS Code å·²æ­£ç¡®è¿æ¥ WSL

åœ¨ VS Code çš„ç»ˆç«¯ä¸­è¾“å…¥ï¼š

```bash
uname -a
```

çœ‹åˆ°è¾“å‡ºåŒ…å« `Linux` å°±è¯´æ˜ä½ å¤„åœ¨ Linux ç¯å¢ƒä¸­ã€‚

ä¾‹å¦‚ï¼š

```
Linux ONEONE 5.15.0-xxxxx ...
```

è¯´æ˜ VS Code å·²æ­£å¸¸å·¥ä½œåœ¨ WSL å†…éƒ¨ã€‚

------

## å®‰è£… C/C++ æ’ä»¶

åœ¨ VS Code æ‰©å±•é‡Œå®‰è£…ï¼š

```
C/C++
```

è¿™ä¸ªæ’ä»¶æä¾›ï¼š

- æ™ºèƒ½è¡¥å…¨ï¼ˆIntelliSenseï¼‰
- è·³è½¬å®šä¹‰
- ä»£ç æ£€æŸ¥
- è°ƒè¯•æ”¯æŒ
- æ ‡å‡†åº“å‡½æ•°æç¤º

é€‚åˆä½ åˆšåˆšå¼€å§‹çš„ C è¯­è¨€å­¦ä¹ ã€‚

------

## ç”¨ VS Code ç¼–å†™å¹¶è¿è¡Œ C ç¨‹åº

ä¾‹å¦‚ä½ çš„ hello.c åœ¨ï¼š

```
~/projects/hello/hello.c
```

ä½ è¿è¡Œï¼š

```bash
code .
```

ç„¶ååœ¨ VS Code çš„ç»ˆç«¯ç¼–è¯‘ï¼š

```bash
gcc hello.c -o hello
```

è¿è¡Œï¼š

```bash
./hello
```

ä½ å°±èƒ½åœ¨ VS Code ä¸‹å®Œæˆä»ç¼–å†™åˆ°è¿è¡Œæ•´ä¸ªæµç¨‹ã€‚

------

## ç›®å½•é€‰æ‹©å»ºè®®

ä¸è¦æŠŠä»£ç æ”¾åœ¨ Windows çš„ `/mnt/c/` ç›®å½•ä¸‹ï¼Œå› ä¸ºæ€§èƒ½éå¸¸å·®ã€‚

æœ€å¥½æ”¾åœ¨ `~/projects`æˆ–ä»»ä½• Linux ä¸»ç›®å½•ä¸‹çš„è·¯å¾„ã€‚

# æ–‡ä»¶æ“ä½œä»£ç 

low_open.c

```c
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>

void error_handling(char* message);

int main(void) {
    int fd;
    char buf[] = "Hello World\n";
    fd = open("data.txt", O_CREAT | O_WRONLY | O_TRUNC);
    if (fd == -1) {
        error_handling("open() error");
    }
    printf("file descriptor: %d\n", fd);

    if (write(fd, buf, sizeof(buf)) == -1) {
        error_handling("write() error");
    }

    close(fd);

    return 0;
}

void error_handling(char* message) {
    fputs(message, stderr);
    fputc('\n', stderr);
    exit(1);
}
```

low_read.c

```c
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>

#define BUF_SIZE 100

void error_handling(char* message);

int main(void) {
    int fd;
    char buf[BUF_SIZE];
    fd = open("data.txt", O_RDONLY);
    if (fd == -1) {
        error_handling("open() error");
    }
    printf("file descriptor: %d\n", fd);

    if (read(fd, buf, sizeof(buf)) == -1) {
        error_handling("read() error");
    }
    printf("file data: %s", buf);

    close(fd);

    return 0;
}

void error_handling(char* message) {
    fputs(message, stderr);
    fputc('\n', stderr);
    exit(1);
}
```

