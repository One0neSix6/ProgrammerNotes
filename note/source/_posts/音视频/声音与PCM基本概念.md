---
title: 声音与PCM基本概念
date: 2025-11-29 17:02:35
categories: 音视频
tags: 音频
---
## 声音是怎么被录下来的

声音本质上是空气的振动（声波）。

- 声波 → 推动麦克风里的振膜震动
- 振动 → 变成电信号（电压高低）
- 电信号 → 送进声卡或录音设备

这一步是**模拟信号**，就像电流忽大忽小。但是计算机没法直接存连续信号，于是要把它转换为 **离散的数值（0/1 二进制）**，转换后的就是**数字信号**。

模拟信号如何变成数字信号？

1. **采样（Sample）—— 采样率**：
    - 每秒钟取很多次声音的“快照”
    - 比如常见的 **44.1kHz** = 每秒采样 44,100 次（CD 音质）
2. **量化（Quantization）—— 位深**：
    - 把每次采样的幅度（电压大小）用二进制数字表示
    - 比如 **16 位量化** → 每个采样点用 16 个二进制位表示

👉 这样，声音就变成了一串数字（原始 PCM 数据）。

## 采样率（Sample Rate）

- 定义：每秒钟对模拟信号取样的次数。
- 单位：Hz（赫兹，次/秒）。
- 常见取值：
    - 8khz：电话等使用，对于记录人声已经足够使用。
    - 22.05khz：广播使用频率。
    - 44.1 kHz（CD 标准，每秒 44100 个点）
    - 48 kHz（视频音频常用标准）
    - 96 kHz、192 kHz（高保真录音）
- 含义：采样率越高，能记录的声音频率范围越宽。
    - **奈奎斯特定理**：采样率至少要是最高音频频率的 2 倍。
    - 人耳大概能听到 20 Hz – 20 kHz，所以 CD 用 44.1 kHz 足够了。

------

## 位深（Bit Depth）

- 定义：表示每个采样点用多少个二进制位存储。
- 常见取值：8 bit、16 bit（CD）、24 bit、32 bit float。
- 含义：位深越高，表示每个点的“精细度”越高 → 动态范围更大、声音更干净。
    - 8 bit：只能记录 256 个数，也就是将振幅划分成 256 个音量级别;
    - 16 bit：2¹⁶ ≈ 65,536 种音量级别；
    - 24 bit：2²⁴ ≈ 1677 万种级别。
- 直观理解：
    - **采样率** 决定声音“还原的频率范围”；
    - **位深** 决定声音“还原的精细程度”。

整数位深与浮点位深的主要区别：

- **精度**：浮点位深比整数位深提供更高的精度，尤其在处理极低音量或高动态范围的音频时，浮点数不会受到量化误差的影响。
- **动态范围**：浮点数的动态范围比整数更大，可以表示更强大的信号差异（例如从非常小的信号到非常大的信号），因此适用于音频处理时的计算需求。
- **使用场景**：整数位深用于录音和播放等需要压缩文件大小和减少计算复杂度的场景；浮点位深更多地应用于音频后期处理、混音和数字信号处理等场合。

------

## 声道数（Channels）

- 定义：同时独立记录的音轨数量。
- 常见取值：
    - 1（单声道 mono）
    - 2（立体声 stereo，左+右）
    - 5.1（环绕声：5 个扬声器 + 1 个低音炮）
    - 7.1、杜比 Atmos（更多声道）
- 含义：声道数越多，空间感和沉浸感越强，但文件也更大。

------

## 比特率/码率

- 定义：单位时间内传输/存储的比特数。
- 单位：bps（bit per second）。
- 分两种情况：
    1. **原始 PCM** → 由采样率 × 位深 × 声道数 决定。
        - 例如：44.1 kHz × 16 bit × 2 = 1411.2 kbps（CD PCM）。
    2. **压缩音频**（MP3、AAC 等） → 通常人为设定（如 128 kbps、320 kbps）。
        - 比特率越高，压缩后音质越好，文件也越大。

通常会预设目标码率/比特率，比如音频 MP3：常见 128 kbps、192 kbps、320 kbps。

**压缩算法会根据预设码率来工作**

- **CBR（Constant Bitrate，固定码率）**：始终维持设定值，比如一直 128 kbps。
- **VBR（Variable Bitrate，可变码率）**：允许在复杂片段用高码率，在简单片段用低码率，但整体平均码率接近设定目标。

## 对比总结

| 概念   | 决定什么         | 单位   | 举例                           |
| ------ | ---------------- | ------ | ------------------------------ |
| 采样率 | 声音的频率范围   | Hz/kHz | 44.1 kHz（CD 标准）            |
| 位深   | 每个采样点的精度 | bit    | 16 bit（CD），24 bit（录音棚） |
| 声道数 | 声音轨道数量     | 无单位 | 2（立体声）、5.1（环绕声）     |
| 比特率 | 每秒数据量       | bps    | PCM 1411 kbps；MP3 128 kbps    |

## 音频存储

经过采样和量化后的数据最原始的就是 **PCM（Pulse Code Modulation，脉冲编码调制）数据**，不压缩，文件很大（WAV 格式常见）。

原始 PCM 数据的大小计算公式：

```
数据率（比特率） = 采样率 × 位深 × 声道数
文件大小 = 数据率 × 时间
```

举例：

- CD 音质：44.1 kHz × 16 bit × 2 = **1411.2 kbps ≈ 1.4 Mbps**
- 每分钟大小：1.4 Mbps × 60 秒 ≈ **10 MB/min**
- 一小时 CD 音频 ≈ **600 MB**（完全无压缩）

## 音频压缩算法及效率

PCM 太大，为了省空间，就需要压缩。

- **无损压缩**（保留所有信息）
    - FLAC、ALAC（苹果）、APE
    - 压缩率：大概 40–70%，即比 PCM 小一半左右
- **有损压缩**（丢掉人耳不敏感的部分，换取更小体积）
    - MP3：常见 128 kbps（10 倍压缩），192/320 kbps 更高音质
    - AAC：比 MP3 效率高 30%左右（同码率下更清晰）
    - Opus：更先进，适合语音、实时通话，低码率表现很好

比如：

- 一首 3 分钟歌：
    - PCM（CD）≈ 30 MB
    - FLAC（无损）≈ 15 MB
    - MP3 128 kbps ≈ 3 MB
    - MP3 320 kbps ≈ 7 MB

## 采集播放流程

> 这是一个简化的流程，实际上远比这个要复杂的多。

### 录音（采集过程）

1. **声波 → 麦克风**
   空气振动 → 麦克风震膜 → 电信号（模拟）。
2. **模数转换（ADC）**
   声卡 / 芯片把模拟信号 → 采样 + 量化 → PCM 数字信号。
3. **压缩（编码）**
   根据设置的格式（MP3 / AAC / Opus），用编码器把 PCM 压缩成更小的码流（文件/数据包）。

### 播放（解码过程）

1. **读取压缩数据**（比如 MP3 文件）。
2. **解码器（Decoder）**
   把 MP3 / AAC → 还原为 PCM。
3. **数模转换（DAC）**
   声卡把 PCM 转成连续电信号（模拟波形）。
4. **功放 + 扬声器**
   电信号推动扬声器振膜 → 振动空气 → 人耳听到声音。

------

## 重采样

**重采样（Resampling）** 指的是 **把一段音频从一种采样率、采样格式、声道数，转换成另一种形式的过程**。它的本质是 **音频数据格式的变换**。

------

### 举个例子

1. 有一段音频，采样率是 **48000 Hz（48kHz）**，单声道，格式是 **16 位整型（S16）**。
    - 意思是每秒采 48000 个点，每个点用 16 位存储。
2. 现在播放器只支持 **44100 Hz（44.1kHz），双声道，浮点型（FLTP）**。
    - 那么就得 **重采样**，把它转换成符合要求的格式。

转换过程可能包括：

- **采样率转换**：48kHz → 44.1kHz
- **声道转换**：单声道 → 双声道
- **采样格式转换**：S16 → FLTP

------

### 为什么需要重采样

1. **不同设备要求不同**
    - 比如 CD 音乐是 44.1kHz，电影音轨可能是 48kHz。要在某个设备上播放，就可能要转换。
2. **音视频同步（AV Sync）**
    - 有时候视频和音频时钟不同步，需要调整音频的采样率，避免声音和画面对不上。
3. **编码器要求**
    - 某些编码器只支持特定格式，比如 AAC 编码通常用 **FLTP**，你就得重采样成它支持的格式。

------

### 在 FFmpeg 里怎么做

FFmpeg 提供了 **`libswresample`** 库来做重采样。

核心步骤是：

1. 创建一个 `SwrContext`（重采样上下文）。
2. 设置输入、输出的参数（采样率、声道数、采样格式）。
3. 使用 `swr_convert` 把音频数据转换到目标格式。
4. 转换后数据可以送去编码、播放等。

