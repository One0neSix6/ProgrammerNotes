---
title: YUV 介绍
date: 2025-11-18 23:08:01
categories: 音视频
tags: 视频
---

## 📌 RGB & RGBA

### RGB

先从 RGB 说起：

- 我们电脑上显示的图像、照片、视频，底层都是 **小像素点（像素，Pixel）** 拼起来的。
- 每个像素由三种颜色组成：**红 (R)、绿 (G)、蓝 (B)**。
- 就像调色盘里三种颜料混合，或像显示屏上三种小灯泡（红灯、绿灯、蓝灯），调节它们的亮度，就能显示不同的颜色。
     👉 这里的只是一个类比，意思是**像素点的颜色是由 R/G/B 三种分量的亮度组合决定的**，而不是说真的有灯泡。

📌 举例：

- 红 255，绿 000，蓝 000 → 纯红色
- 红 000，绿 255，蓝 000 → 纯绿色
- 红 000，绿 000，蓝 255 → 纯蓝色
- 红 255，绿 255，蓝 255 → 白色
- 三个都调到 0 → 黑色

所以，**RGB 是直接表示颜色的方法**，非常直观。

### RGBA

RGBA 在 RGB 的基础上，加了一个 **A = Alpha（透明度通道）**：

- A 的取值范围：
    - **0** → 完全透明（像玻璃，什么都看不到）
    - **255** → 完全不透明
    - 中间值 → 半透明（能看到下面一部分内容）

📌 示例：

- (255, 0, 0, 255) → 纯红色，不透明
- (255, 0, 0, 128) → 半透明红色
- (255, 0, 0, 0) → 透明红色（看不到）

------

## 📌 YUV

### 定义

**YUV** 是一种颜色编码模型（Color Encoding Model），最早由 **PAL（Phase Alternating Line）彩色电视系统**提出，后广泛应用于视频压缩与传输。

它把颜色信息分为两类：

- **Y（Luma，亮度分量）**

    - 表示像素的灰度（亮度）信息，基本决定画面的清晰度。

    - 数学上是 RGB 分量加权和：

        Y=0.299R+0.587G+0.114B（权重来自人眼对不同颜色敏感度：对绿色最敏感，对蓝色最不敏感）

- **U/V（Chroma，色度分量）**

    - U：蓝色分量与亮度的差异（B-Y）
    - V：红色分量与亮度的差异（R-Y）
    - 它们一起描述了“色彩”和“饱和度”。

换句话说：**Y = 黑白信息、U、V = 彩色信息**

👉 这样做的原因是：人眼对亮度比对颜色更敏感，所以我们可以保留更多亮度信息，少存一些颜色信息，从而**节省存储空间和带宽**。

📌 举例：

- 如果你看黑白电视，只有 Y 分量，没有 U/V 分量。你依然能清晰看到画面，只是没有颜色。
- 如果你只看 U/V（颜色）而没有 Y（亮度），画面会模糊得看不清。

------

### YUV 的采样方式

采样方式就是：对 **Y、U、V** 分量的数据，按照怎样的比例存储。

常见方式有：**YUV444、YUV422、YUV420**。

#### YUV444

- 每个像素都有 Y、U、V 三个分量。
- 数据量最大。
- 质量最高。

📌 示例（2x2 像素）：

```
像素1: Y1 U1 V1
像素2: Y2 U2 V2
像素3: Y3 U3 V3
像素4: Y4 U4 V4
```

#### YUV422

- 每两个像素共用一组 U/V。
- 水平方向采样减半。
- 数据量减少 1/3，质量略降。

📌 示例（2x2 像素）：

```
像素1: Y1 U1 V1
像素2: Y2 U1 V1   （共用 U/V）
像素3: Y3 U2 V2
像素4: Y4 U2 V2
```

#### YUV420

- 每 **2x2 的 4 个像素** 共用一组 U/V。
- 水平 + 垂直都采样减半。
- 数据量只有 YUV444 的一半，最常用。（H.264、H.265、VP9 等编码标准都用 YUV420）

📌 示例（2x2 像素）：

```
Y1  Y2
Y3  Y4
UV 共用一组 (U1,V1)
```

------

### YUV 的存储方式

YUV 不只是采样方式，还要考虑 **存储在内存中的排列**。
 常见的存储方式有：

#### Planar 模式（平面）

Y、U、V 分量分别存放。

- **YUV420P** (Planar)：
    - 先存 Y（所有像素的亮度）
    - 再存 U（缩小一半的色度）
    - 再存 V（缩小一半的色度）

📌 内存示意（4x4 图像）：

```
YYYY
YYYY
YYYY
YYYY
UU
UU
VV
VV
```

👉 这里 P = Planar（平面存储）。

#### Semi-Planar 模式（半平面）

Y 单独存，U/V 交错存放。

- **NV12**：
    - 先存 Y
    - 再存 UVUVUV…（交错）
- **NV21**：
    - 先存 Y
    - 再存 VUVUVU…（交错，U/V 交换）

📌 内存示意（4x4 图像）：

```
YYYY
YYYY
YYYY
YYYY
UVUV
UVUV
```

👉 这里 NV = **Non-Planar Video**（半平面交错）。

------

#### Packed（打包存储）

- Y、U、V 按像素交织存放。
- 常见：`YUYV422`。

📌 内存示意（4x4 图像）：

```
YUV YUV 
YUV YUV
```

### 常见的 YUV 位深（bit depth）

1. **8 bit（最常见）**

    - 每个分量占 **1 个字节**（0–255）。
    - Y: 表示亮度，范围 0–255。
    - U/V: 表示色度，通常范围 -128–127（存储时映射到 0–255）。
    - 大部分视频文件（H.264/H.265、VP9 等）和原始 YUV 测试数据都是 8 bit。

    📌 举例：YUV420P，分辨率 1920x1080

    - Y 分量：1920×1080 = 2073600 字节
    - U 分量：960×540 = 518400 字节
    - V 分量：960×540 = 518400 字节
    - 总大小 ≈ 3 MB

2. **10 bit / 12 bit（高位深视频）**

    - 每个分量需要 **10 位** 或 **12 位**来表示。
    - 常见于 HDR（高动态范围）视频。
    - 存储方式可能是：
        - **打包模式**（10 bit 连续存，不对齐 1 字节），效率高但读取麻烦。
        - **对齐模式**（每个分量用 16 bit = 2 字节存储），浪费空间但读取方便。

    📌 举例：10-bit YUV420P，分辨率 1920x1080

    - 如果按 2 字节对齐：
        - Y 分量：1920×1080×2 ≈ 4 MB
        - U 分量：960×540×2 ≈ 1 MB
        - V 分量：960×540×2 ≈ 1 MB
        - 总大小 ≈ 6 MB，比 8 bit 多一倍。

3. **浮点数存储**
    - 在一些图像处理库（如 OpenGL / Vulkan / OpenCV 中间格式）里，Y/U/V 分量可能用 `float`（4 字节）存储，用于高精度计算。
    - 不适合视频存储，但适合视频渲染或特效处理。

------

### 与 RGB 的关系

YUV 并不是独立于 RGB 的，它其实是 **RGB 颜色空间的一种线性变换**。

一个常见的变换矩阵为（ITU-R BT.601 标准，SDTV 常用）：
$$
\begin{bmatrix} Y \\ U \\ V \end{bmatrix} = \begin{bmatrix} 0.299 & 0.587 & 0.114 \\ -0.147 & -0.289 & 0.436 \\ 0.615 & -0.515 & -0.100 \end{bmatrix} \cdot \begin{bmatrix} R \\ G \\ B \end{bmatrix}
$$
可以看到，Y 是亮度的加权和，而 U、V 是色度差分量。
 这意味着：

- 从 YUV 可以反算回 RGB（解码时需要）。
- YUV 只是 RGB 的一种压缩表达。

------

### 优势

- **符合人眼感知特性**
    - 人眼对亮度敏感，对色度不敏感。
    - 所以可以对色度进行抽样压缩（如 YUV420）。
- **便于压缩**
    - 视频编码（H.264/H.265/VP9/AV1）几乎都基于 YUV420。
    - 因为这样能在保持清晰度的同时，显著降低数据量。
- **广泛应用**
    - 摄像头、编解码器、视频存储、图像处理管线。
    - 操作系统图形 API（DirectX、Vulkan、FFmpeg 等）普遍支持 YUV。

------

### 应用领域

- **视频编码与传输**：H.264/H.265、MPEG、VP9、AV1 等。
- **摄像头和显示设备**：内部数据流常用 YUV420。
- **视频渲染和处理**：FFmpeg、OpenCV、GPU 视频加速。

## 📊 总结

YUV 是一种颜色编码方式，把图像分为亮度 (Y) 和色度 (U/V) 分量。这样做符合人眼对亮度敏感、对色度不敏感的特性，因此在视频处理中常用 YUV420 等采样格式来压缩色度信息，在保证清晰度的同时显著降低存储和带宽需求。它本质上是 RGB 的线性变换，广泛应用于视频采集、编码和传输。
