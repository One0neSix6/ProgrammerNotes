---
title: WAV格式说明
date: 2025-11-29 17:30:30
categories: 音视频
tags: 
  - 封装格式
  - 音频
---
## 基本定义

- **全名**：WAVE（Waveform Audio File Format），扩展名通常是 `.wav`
- **归属**：由微软和 IBM 在 1991 年左右提出，基于 RIFF（Resource Interchange File Format）容器格式
- **本质**：一种**音频容器格式**，里面通常存放 **线性 PCM（LPCM）** 音频数据，也可以存其他压缩编码（ADPCM、MP3 等），只不过**最常见、最经典的是未压缩的 PCM**。

在大部分普通语境下说「WAV 音频」，十有八九指的是 PCM 编码。

------

## WAV / RIFF 文件整体结构概览

WAV 基于 RIFF，所以文件结构非常规律，核心是「**Chunk（块）**」的概念。

![图片来源 http://soundfile.sapp.org/doc/WaveFormat/](https://blog-1314964800.cos.ap-beijing.myqcloud.com/image-20251129174104481.png)

字段说明：

- **RIFF** **Chunk**：RIFF 是 WAV 文件的根块，包含了文件的基本信息。
    - **Chunk ID**：通常是 “RIFF” 字符串，表示这个文件是 RIFF 格式。
    - **Chunk Size**：是 RIFF 数据的总大小，等于文件大小减去 8 字节（`RIFF` 和 `Chunk Size` 的长度）。
    - **Format**：通常是 "WAVE" 表示音频文件的类型。
- **fmt Chunk**：定义了音频的基本格式参数。
    - **Chunk ID**：固定为 "fmt "（注意空格），表示格式信息。
    - **Chunk Size**：指定 fmt 子块的大小（通常是 16 或 18 字节）。
    - **Audio Format**：音频格式，0x0001 表示未压缩 PCM 音频格式。
    - **Num Channels**：声道数，通常为 1（单声道）或 2（立体声）。
    - **Sample Rate**：采样率（如 44100 Hz、48000 Hz 等）。
    - **Byte Rate**：每秒字节数，计算方式为 `SampleRate * NumChannels * BitsPerSample / 8`。
    - **Block Align**：数据块对齐大小，计算方式为 `NumChannels * BitsPerSample / 8`。
    - **Bits** **Per Sample**：每个采样点的位深度（常见有 8 位、16 位、24 位等）。
- **data Chunk**：存储实际音频数据。
    - **Chunk ID**：固定为 "data"。
    - **Chunk Size**：数据块的大小，表示数据的字节数。
    - **Data**：音频数据，存储采样值的序列。

------

## 关键参数

WAV 最重要的三个参数：

### 采样率

- 单位：Hz（次/秒）
- 表示：每秒从模拟波形中取多少个点进行量化
- 常见采样率：
    - 44100 Hz：CD 音质标准（Audio CD）
    - 48000 Hz：视频、影视、DVD、数字电视常用
    - 96000 Hz、192000 Hz：高采样率录音（专业音频）

**奈奎斯特定理**告诉我们：采样率至少是信号最高频率的两倍才能完整还原。人耳大致听到 20 kHz，所以 44100 Hz 对应约 22.05 kHz 的带宽。

### 位深

- 表示：每一个采样点用多少位二进制来表示幅度
- 常见值：
    - 8-bit：质量较差，多用于早期设备 / 电话等
    - 16-bit：CD 标准（96 dB 动态范围），通用音乐发行标准
    - 24-bit：录音室、混音阶段常用（更高动态范围）
    - 32-bit float：浮点格式，更适合音频处理（避免剪切失真）

位深越高：

- 能表示的 **动态范围**越大
- 音量细节更细腻
- 文件体积也会增大

### 声道数

- 1：单声道（Mono）
- 2：立体声（Stereo）

对 PCM WAV 来说，多个声道通常是 **交错存储**（interleaved），例如立体声时样本序列是：

```text
L1, R1, L2, R2, L3, R3, ...
```

------

## WAV 的数据率和文件体积计算

对于 PCM WAV 文件，数据率（ByteRate）公式是：

```text
ByteRate = SampleRate × NumChannels × BitsPerSample / 8
```

举个例子：CD 标准音频

- 采样率：44100 Hz
- 位深：16-bit
- 声道：2（立体声）

则：

```text
ByteRate = 44100 × 2 × 16 / 8 = 176400 字节/秒 ≈ 172 KB/s
```

文件体积估算（不考虑头部开销，大致）：

> 大小（字节） ≈ ByteRate × 时长（秒）

比如 1 分钟的 CD 质量 WAV：

```text
176400 × 60 ≈ 10,584,000 字节 ≈ 10.1 MB
```

------

## WAV 容器 vs PCM 编码

很多人会把「WAV = PCM」，实际上要稍微区分一下：

- **WAV（.wav）**：是一种「容器格式」，类似「一个盒子」，可以装多种类型的数据
- **PCM（Pulse Code Modulation）**：是一种「编码方式」，表示「不压缩的原始采样值」

常见组合：

- **WAV + PCM**：最经典、最常用，几乎所有软件都兼容
- WAV + ADPCM：如 IMA ADPCM 等压缩格式，多用于早期游戏 / 语音
- WAV 里甚至可以封装 MP3、AAC 等（但不常见，兼容性一般）

大多数播放器看到 `.wav` 会**假定**它是 PCM，少数情况是压缩的，就会需要看 `fmt` chunk 中 `AudioFormat` 字段来判断编码类型。

------

## WAV 的优点与缺点

### 优点

1. **无损 / 高音质（PCM 情况下）**
    - 不压缩或仅做线性量化编码，没有有损压缩导致的细节丢失。
2. **格式简单、解析容易**
    - 结构清晰（RIFF + Chunk），非常适合音频开发和底层处理。
3. **兼容性极好**
    - Windows / Mac / Linux / 各种 DAW（数字音频工作站）都支持。
    - 各种播放器、编辑软件都可以直接处理。
4. **编辑友好**
    - 因为不压缩，剪辑 / 混音的时候不会出现反复压缩造成的质量损失。
5. **适合中间格式**
    - 在「录音 → 后期处理 → 导出发布」这个流程中，WAV 常用作「中间格式」。

### 缺点

1. **文件体积巨大**
    - 相比 MP3 / AAC 等有损压缩格式，体积可以大 5～10 倍以上。
2. **传输和存储成本高**
    - 对网络传输、移动设备存储不太友好。
3. **不适合直接对外发布/分发（to C）**
    - 面向普通用户播放会浪费带宽，大部分流媒体平台都会转成 MP3/AAC/Opus。

------

## WAV 与其他音频格式的对比

### WAV vs MP3

- WAV（PCM）：
    - 无损、未压缩
    - 文件大
    - 适用于录音、编辑、存档
- MP3：
    - 有损压缩
    - 文件小得多（比如 128kbps、320kbps）
    - 适合最终发行、下载、普通听歌

### WAV vs FLAC

- WAV（PCM）：
    - 无损：不压缩，数据冗余高
    - 文件体积较大
    - 结构简单
- FLAC：
    - 无损压缩：可以把 PCM 压缩到原来的 40～60% 大小
    - 同样无损，解压还原的波形完全一致
    - 更适合作为长时间存档格式（音乐收藏）

很多音乐发烧友会用 FLAC 做收藏，用 WAV 做中间处理（编辑、混音时）。

### WAV vs AIFF

- 两者非常相似：
    - 都是无压缩 PCM 容器（常用情况）
    - AIFF 常见于 Apple / macOS 平台
    - WAV 常见于 Windows / PC 平台
- 区别主要在于：
    - 封装规范不同（RIFF vs IFF）
    - 元数据支持和兼容性略有差别

------

## WAV 常见使用场景

1. **录音 / 采样**
    - 录音棚录人声、乐器
    - 采集环境音、音效
2. **混音 / 后期制作**
    - DAW（比如 Cubase、Pro Tools、Logic、Reaper）内部都习惯使用 WAV/AIFF
    - 效果器链处理过程中的中间文件
3. **游戏 / 多媒体素材**
    - 游戏引擎（Unity、Unreal）里导入的音效往往使用 WAV（尤其是短音效）
    - 后续由引擎自行压缩或转码
4. **系统提示音**
    - Windows 等系统的提示音、软件音效常用 WAV
5. **检测 / 调试 / 测试**
    - 算法验证、信号处理实验（滤波器测试、语音识别前端）时，经常用 WAV 来存原始数据。

------

## 关于 WAV 的一些细节与坑

### 文件头大致固定，但 Chunk 可以不止两个

除了 `fmt` 和 `data`，WAV 还可以有：

- `LIST`：元数据（比如作者、注释等）
- `cue `：标记点信息
- `fact`：某些压缩格式的辅助数据

所以解析 WAV 时不要「死认」固定偏移，一般是按 Chunk 标签顺序解析。

### PCM 数据的排列方式

以典型 16-bit、立体声 PCM 为例：

- 一帧 = 左声道 1 个采样 + 右声道 1 个采样
- 每个采样 16-bit = 2 字节
- 一帧一共 4 字节：`L_low, L_high, R_low, R_high`（小端序）

### 大小端（Endianness）

- WAV（基于 RIFF）使用 **小端序（Little-endian）**
- 在 x86 平台（Windows 常见）上很好对接

### 32-bit float WAV

很多专业录音/处理环境会采用 **32-bit float** 存储音频：

- 范围一般是 `[-1.0, 1.0]` 浮点数
- 方便后期做动态增益、EQ、压缩等处理而不容易造成「爆音剪切」

