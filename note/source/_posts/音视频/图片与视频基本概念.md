---
title: 图片与视频基本概念
date: 2025-11-20 22:30:15
categories: 音视频
tags: 视频
---

## 图片

**本质**：图片是由很多个小方格（像素，pixel）按规则排列组合而成，每个像素保存颜色信息。

- 一个像素（在常见的 RGB24 格式里）包含 3 个分量：R、G、B，每个分量 8 位（1 字节）。
    - 所以一个像素占用 3 字节（R、G、B）。
- 图片的尺寸就是 **宽 × 高**，例如 `1920 × 1080` 表示每行 1920 个像素、共有 1080 行。

假设一张 1920×1080 的 RGB24 图片：

1. 像素总数 = 1920 × 1080 = 2,073,600 像素。
2. 每像素 3 字节 ⇒ 每帧字节数 = 2,073,600 × 3 = **6,220,800 字节 = 6075 KB ≈ 5.93 MB**。

------

## 分辨率

- **分辨率（Resolution） = 图片的宽 × 高（像素）**，决定了图片的“细节量”。
    - 更高分辨率 → 每帧包含更多像素 → 能表现更细致的细节。
- 常见分辨率举例：
    - 1280×720（720p）
    - 1920×1080（1080p / Full HD）
    - 3840×2160（4K / UHD）

分辨率只说明像素数量，不直接说明文件大小，还受每像素位深、颜色格式与压缩影响。

## 像素的位深

- **定义**：一个像素整体使用多少位来表示。
- 举例：
    - **RGB24**
        - R: 8 位
        - G: 8 位
        - B: 8 位
        - 合起来一个像素 = 24 位 = 3 字节
    - **RGB30**
        - R: 10 位
        - G: 10 位
        - B: 10 位
        - 一个像素 = 30 位 ≈ 4 字节（因为要对齐到字节存储）

👉 像素位深 = **R+G+B 或 Y+U+V 各自位数的总和**。

------

## 视频

- **视频 = 按时间顺序连续播放的一系列图片（帧）**。
- 每秒播放多少帧叫 **帧率（Frame Rate, fps）**。例如 30 fps 表示每秒播放 30 幅静态图片。
- 通过快速连续播放静止画面，人眼产生“运动连续性”的错觉（persistence of vision）。

常用帧率：

- **24 fps**：电影常用，视觉上“电影质感”。

- **25 fps**：欧洲电视制式（PAL）常见。
- **30 fps**：常见于网络视频、手机录像（NTSC/近似）。
- **60 fps / 120 fps**：游戏、高帧率视频，动作更流畅。

帧率越高 → 单帧停留时间越短 → 运动更平滑，但需要更多数据（或更高压缩率）。

**举例**：30 fps 的 10 秒视频就是 30 × 10 = 300 张图片按顺序播放。

## 码率

- **码率（bitrate）= 每秒钟视频数据量（bit/s）**
- 单位：
    - bps = bit per second（比特/秒）
    - 常见有 **kbps（千比特/秒）、Mbps（兆比特/秒）**

✅ **一句话总结：码率就是视频每秒需要的数据量，决定了文件大小和画质。高码率=清晰但大文件，低码率=模糊但省空间。**

### 不考虑压缩场景

如果每一帧都当作一张完整图片存储：

码率=单帧大小×帧率码率 = 单帧大小 × 帧率

这样算出来的是**原始视频码率（Raw bitrate）**。

#### 举例

- 一张 1920×1080（1080p）、24 位色深（3 字节/像素）的图片：
    - 单帧大小 = 1920 × 1080 × 3 ≈ 6 MB
- 如果是 30 帧/秒：
    - 码率 = 6 MB × 30 = 180 MB/s
    - = 1440 Mbps

⚠️ 算出来的原始视频码率非常大，存 1 分钟视频要好几十 GB，所以不能直接存。

------

### 压缩场景

视频压缩（比如 H.264、H.265）会大幅减少存储量：

- 它不是存每一帧完整图片，而是存“关键帧 + 变化信息”。
- 所以实际的**压缩后码率**要小得多（通常是几十 Mbps，甚至几 Mbps）。

👉 举例：

- 上面算的 1080p 30fps 原始视频 = **1440 Mbps**
- 压缩成 H.264 后 → 只需要 **4–6 Mbps** 就能有不错的画质
- 压缩效率 ≈ 200～300 倍

------

### 总结

- 理论公式：**码率 = 单帧大小 × 帧率**（原始视频情况下）
- 实际视频：因为有压缩（帧内 + 帧间），码率会大幅下降
- 所以码率通常是 **设定值**，取决于压缩算法和清晰度需求

------

### 作用

在视频编码（比如 H.264）里，**码率就像是一个“预算”**：

- 你告诉编码器：“每秒钟最多只能用 X 比特的数据”
- 编码器就会在这个预算内，想办法存储视频 → 压缩更多 or 保留更多细节

所以，**码率不是结果，而是目标**。

------

### 编码器是怎么做的？

举个例子，假设你设定码率 = 4 Mbps：

- 如果画面很简单（黑屏、PPT、会议视频）：
    - 编码器发现“变化少”，很容易压缩
    - 4 Mbps 的预算没花完 → 画质就很好，甚至浪费了一点空间
- 如果画面很复杂（动作片、烟花、草地、大海）：
    - 编码器发现“细节很多，很难压缩”
    - 但预算只有 4 Mbps → 它必须丢掉一部分细节
    - 结果就是：画面会出现模糊、马赛克

------

### 码率和画质的关系

- **高码率**：预算充足，压缩轻一点 → 画质好，但文件大
- **低码率**：预算紧张，压缩狠一点 → 画质差，但文件小

------

### 两种常见方式

- **CBR（固定码率，Constant Bitrate）**
    - 每秒用的数据量基本固定
    - 适合直播、实时传输（带宽可控）
    - 但有时画面复杂 → 画质下降
- **VBR（可变码率，Variable Bitrate）**
    - 遇到复杂画面就多花点码率，简单画面就少花点
    - 平均下来还是控制在目标范围
    - 适合本地视频存储，画质更稳定

## 视频压缩

- 一张未压缩的 1920×1080（1080p）、24 位位深的图片大小：

    ```
    1920 × 1080 × 3字节 ≈ 6 MB
    ```

- 如果 30 帧/秒：

    ```
    6 MB × 30 ≈ 180 MB/s
    1 分钟 ≈ 10 GB
    ```

- 如果 60 帧/秒：

    ```
    6 MB × 60 ≈ 360 MB/s
    1 分钟 ≈ 21 GB
    ```

原始视频体积会非常庞大，无法存储、传输，所以必须压缩。

------

### 压缩方式

#### 帧内压缩（Intra-frame Compression）

- **对象**：单帧内部。
- **思想**：像 JPEG 压缩图片一样，利用空间冗余（相邻像素相似）。
- **方法**：分块（如 8×8）、DCT 变换、量化、熵编码。
- **特点**：独立解码，不依赖其他帧。

#### 帧间压缩（Inter-frame Compression）

- **对象**：相邻帧之间。
- **思想**：利用时间冗余（前后画面大部分相似）。
- **方法**：运动估计（找相似块）、运动补偿（记录运动矢量）、残差编码。
- **特点**：依赖参考帧，解码复杂度高，但压缩效率更好。

------

## I / P / B 帧

### I 帧（Intra Frame）

- 就是关键帧，完整的一张图片。
- 只用 **帧内压缩**。
- 优点：独立解码，作为视频的“锚点”。

### P 帧（Predicted Frame）

- 前向预测帧，只存相对于前一帧（I 或 P）的变化。比如：`I → P → P → P`，每个 P 都参考它前面的那个。
- **以帧间压缩为主**，但部分区域可能会用帧内压缩。
- 优点：体积比 I 帧小。

### B 帧（Bi-directional Frame）

- 双向预测帧，参考前后帧（I 或 P）。比如：`I B B P`，这两个 B 帧既参考了前面的 I，又参考了后面的 P。
- **以帧间压缩为主**，也可能混合少量帧内压缩。
- 优点：压缩率最高，但解码最复杂。

👉因为要参考前后帧，所以解码顺序 ≠ 播放顺序。

- 播放顺序：`I B B P`
- 解码顺序：`I P B B`（因为要先解码 P，B 才能参考）。

------

### GOP（Group of Pictures）

- **定义**：I 帧 + 若干 P/B 帧组成的一个组。
    - GOP = 从一个 I 帧到下一个 I 帧这段帧序列。GOP length = I 帧之间的帧数
- 作用：决定了压缩效率和随机访问性能。

📌 举例：
 一个 GOP 长度 = 12，可能的排列是：

```
I B B P B B P B B P B B
```

- 开头的 I 帧是锚点。
- 中间 P 帧依赖前面的 I 或 P。
- B 帧依赖前后的 I/P。

📊 特性：

1. **压缩率 （越长越高）**
    - 原因：I 帧通常体积最大（因为完整），P/B 相对小。GOP 越长，I 帧占比越低 → 平均每帧数据更少 → 总体更省空间。
2. **随机跳转/seek 慢（越长越慢）**
    - 原因：如果你在播放器中跳到时间 t，播放器通常先定位到时间 t 所在之前最近的 I 帧，然后从该 I 帧开始解码直到 t，才能把 t 帧显示出来。GOP 越长，最坏情况要从更早的 I 解码更多帧 → 等待时间更长、CPU 负担更大。
3. **错误传播窗口变大（越长越差）**
    - 如果网络丢包或文件损坏，丢失或损坏的 I/P 会影响其后直到下一个 I 的所有依赖帧；GOP 越长，受影响的帧越多。
4. **实时性 / 延迟**
    - 长 GOP + 多 B 帧会增加编码器/解码器的缓冲与延迟，不利于低延迟场景（直播、视频会议）。
